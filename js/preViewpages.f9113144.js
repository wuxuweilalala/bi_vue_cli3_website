(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["preViewpages"],{"700e":function(e,t,a){"use strict";var i=a("7fe2"),o=a.n(i);o.a},"7fe2":function(e,t,a){},eaef:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper",class:e.canvasPositionClass,style:{backgroundColor:e.bgColor,backgroundImage:"url("+e.imgBase64+")",height:e.isMobileDevice?100*e.mobilePagesNum+"vh":e.dashboardHeight+"px",width:e.isMobileDevice?"100vw":e.dashboardWidth+"px"}},[e.isMobileDevice&&!e.dataIsOk?a("loading-rotating",{attrs:{styleObj:e.styleObj}}):e._e(),e.isMobileDevice?e._e():a("Loading",{attrs:{dataIsOk:e.dataIsOk,styleObj:e.styleObj}}),e._l(e.getChartList,(function(t,i){return a("div",{key:i,staticClass:"component-container",style:{width:e.isMobileDevice?Number(t.containerOptions.tableWidthMobile*e.screenWidth)+"px":Number(t.containerOptions.tableWidth)+"px",height:e.isMobileDevice?Number(t.containerOptions.tableHeightMobile)+"px":Number(t.containerOptions.tableHeight)+"px",left:(e.isMobileDevice?Number(t.containerOptions.xPositionMobile):Number(t.containerOptions.xPosition))+"px",top:(e.isMobileDevice?Number(t.containerOptions.yPositionMobile):Number(t.containerOptions.yPosition))+"px",position:e.isMobileLayoutSaved||!e.isMobileDevice?"absolute":"static",float:e.isMobileLayoutSaved?"usnet":"left",zIndex:Number(t.containerOptions.level)||0}},[a(t.containerOptions.chartsType,{tag:"component",style:{"z-index":t.containerOptions.level+3||3},attrs:{chartIndex:i,options:t.renderOptions,containerOptions:t.containerOptions,containerStatus:t.containerStatus,isSetOptions:t.containerStatus.isSetOptions}})],1)}))],2)},o=[],s=(a("99af"),a("4de4"),a("4160"),a("d81d"),a("a9e3"),a("ac1f"),a("466d"),a("1276"),a("159b"),a("2909")),n=a("5530"),r=a("2f62"),c=a("0c2e"),h=a("8416"),d=(a("007c"),a("0d29")),l=(a("07a4"),{name:"PreviewPages",mixins:[h["a"]],components:{Loading:c["a"]},data:function(){return{isMobileLayoutSaved:!1,isMobileDevice:!1,mobilePagesNum:1,shareType:1,dataIsOk:!1,recordTime:5e3,intervalId:0,styleObj:{width:"100%",height:"100%"},bgColor:"",imgBase64:"",dashboardWidth:"",dashboardHeight:""}},computed:Object(n["a"])({canvasPositionClass:function(){if(this.isMobileDevice)return["mobileLayout"];var e=[];return this.screenWidth>this.dashboardWidth&&this.screenHeight>this.dashboardHeight?(e.push("allCenter"),e):(this.screenWidth>this.dashboardWidth&&e.push("aCenter"),this.screenHeight>this.dashboardHeight?e.push("vCenter"):e.push("overflowY"),e)}},Object(r["c"])("main",{screenWidth:"getScreenWidth",screenHeight:"getScreenHeight"}),{},Object(r["c"])("canvasPlace",{chartList:"getChartList",scaleLevel:"getScaleLevel",renderedChartCount:"getRenderedChartCount"}),{},Object(r["c"])("config",{baseUrl:"baseUrl"}),{getChartList:function(){return this.isMobileDevice?this.chartListFilter:this.chartList},chartListFilter:function(){return this.chartList.filter((function(e){return e.containerOptions.showInMobileLayout&&e.containerStatus.isSetOptions}))}}),watch:{dataIsOk:function(e){e&&document.dispatchEvent(new Event("render-active"))}},methods:{activateSocket:function(e){var t=this,a="wss://socketbi.24e.co/";this.ws=new WebSocket(a),this.ws.onopen=function(e){},this.ws.onmessage=function(a){var i=JSON.parse(a.data);i.connectFd?(e.fd=i.connectFd,t.axios.get("https://pushbi.24e.co",{params:e}).then((function(e){}))):t.$store.dispatch("canvasPlace/screeningRequest")}},closeSocket:function(){this.ws.close()},getUrlParams:function(e,t){var a=this,i={shareSn:a.$route.query.share_sn,password:a.$route.query.password,shareScreenData:e||[]},o="".concat(a.baseUrl,"api/shareInfo");a.axios.post(o,i).then((function(e){var i=e.data;if(console.log("resNew",i),console.log(i.data.dashboardBgColor),a.bgColor=i.data.dashboardBgColor||"#0b0e14",a.imgBase64=i.data.dashboardBgImage,a.dashboardHeight=i.data.dashboardHeight,a.dashboardWidth=i.data.dashboardWidth,"000000"==i.code){if(i.data.pushInfo.pushState&&!t&&a.activateSocket({product_sn:i.data.project_sn,time:i.data.pushInfo.pushTime}),a.dataIsOk=!0,document.title=i.data.project_name,a.isMobileLayoutSaved=i.data.isMobileLayoutSaved,a.shareType=i.data.share_type,a.$store.commit("canvasPlace/clearArrChart"),!a.chartList.length){var o=i.data.share_info;o.length?o.forEach((function(e,t){var i=e.containerOptions;e.containerOptions.chartsType.split("-")[0];2==a.shareType&&(i.xPosition=0,i.yPosition=0);var o={id:t,containerOptions:i,containerStatus:{isSetOptions:!0,dataDimensionShow:!1,isDeleted:!1,isShowLoading:!1}},s=Object(d["a"])(e).renderOptions;a.$set(o,"renderOptions",s),a.$store.commit("canvasPlace/setChartList",o)})):a.dataIsOk=!0}}else a.dataIsOk=!0,a.tips.show([i.err_msg])})).catch((function(e){a.dataIsOk=!0,console.error(e)}))},recordShareTime:function(){var e=this,t="".concat(e.baseUrl,"api/recordShare"),a=e.$route.query.share_sn,i=e.$route.query.func||"",o=setInterval((function(){i?clearInterval(o):e.axios.get("".concat(t,"?share_sn=").concat(a)).then((function(t){"000000"!=t.data.code&&e.tips.show([t.data.err_msg])})).catch((function(e){return console.error(e)}))}),5e3)}},beforeMount:function(){this.isMobileDevice=null!=navigator.userAgent.toLowerCase().match(/(ipod|iphone|android|coolpad|mmp|smartphone|midp|wap|xoom|symbian|j2me|blackberry|wince)/i)},mounted:function(){this.$on("sb",(function(e){console.log("hahahah",e)}));var e=this;e.getUrlParams(),e.recordShareTime(),setTimeout((function(){if(e.isMobileDevice){document.querySelector("html").style.overflow="auto";var t=e.chartListFilter.map((function(e){return Number(e.containerOptions.yPositionMobile)+Number(e.containerOptions.tableHeightMobile)})),a=t.length?Math.max.apply(Math,Object(s["a"])(t)):1;e.mobilePagesNum=a>1?Math.ceil(a/e.screenHeight):1,console.log(e.mobilePagesNum)}}),1e3)}}),u=l,b=(a("700e"),a("0c7c")),p=Object(b["a"])(u,i,o,!1,null,"6fe48e12",null);t["default"]=p.exports}}]);
//# sourceMappingURL=preViewpages.f9113144.js.map